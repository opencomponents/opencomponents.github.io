"use strict";(self.webpackChunkoc_website=self.webpackChunkoc_website||[]).push([[1111],{6242:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"consumers/server-side-rendering","title":"Server-side Rendering","description":"You can get rendered components via the registry rest api.","source":"@site/docs/consumers/server-side-rendering.md","sourceDirName":"consumers","slug":"/consumers/server-side-rendering","permalink":"/docs/consumers/server-side-rendering","draft":false,"unlisted":false,"editUrl":"https://github.com/opencomponents/opencomponents.github.io/tree/master/website/docs/consumers/server-side-rendering.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"Client-side Rendering","permalink":"/docs/consumers/client-side-rendering"},"next":{"title":"Batch Endpoint","permalink":"/docs/consumers/batch-endpoint"}}');var o=r(4848),s=r(8453);const i={sidebar_position:6},c="Server-side Rendering",a={},l=[{value:"Web Framework Integration Examples",id:"web-framework-integration-examples",level:2},{value:"Express.js Integration",id:"expressjs-integration",level:3},{value:"Koa.js Integration",id:"koajs-integration",level:3},{value:"Next.js Integration",id:"nextjs-integration",level:3},{value:"Caching Strategies",id:"caching-strategies",level:2},{value:"Redis Caching",id:"redis-caching",level:3},{value:"Memory Caching with LRU",id:"memory-caching-with-lru",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Graceful Fallbacks",id:"graceful-fallbacks",level:3},{value:"Timeout Handling",id:"timeout-handling",level:3},{value:"Available Clients",id:"available-clients",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"server-side-rendering",children:"Server-side Rendering"})}),"\n",(0,o.jsx)(n.p,{children:"You can get rendered components via the registry rest api."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'curl http://my-components-registry.mydomain.com/hello-world\n\n{\n  "href": "https://my-components-registry.mydomain.com/hello-world",\n  "version": "1.0.0",\n  "requestVersion": "",\n  "html": "<oc-component href=\\"https://my-components-registry.mydomain.com/hello-world\\" data-hash=\\"cad2a9671257d5033d2abfd739b1660993021d02\\" id=\\"2890594349\\" data-rendered=\\"true\\" data-version=\\"1.0.13\\">Hello John doe!</oc-component>",\n  "type": "oc-component",\n  "renderMode": "rendered"\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Nevertheless, for improving caching and response size, when using the ",(0,o.jsx)(n.code,{children:"node.js"})," client or any language capable of executing server-side javascript the request will look more like:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:' curl http://my-components-registry.mydomain.com/hello-world/~1.0.0 -H Accept:application/vnd.oc.unrendered+json\n\n{\n  "href": "https://my-components-registry.mydomain.com/hello-world/~1.0.0",\n  "version": "1.0.0",\n  "requestVersion": "~1.0.0",\n  "data": {\n    "name": "John doe"\n  },\n  "template": {\n    "src": "https://s3.amazonaws.com/your-s3-bucket/components/hello-world/1.0.0/template.js",\n    "type": "oc-template-es6",\n    "key": "cad2a9671257d5033d2abfd739b1660993021d02"\n  },\n  "type": "oc-component",\n  "renderMode": "unrendered"\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"In this case you get the compiled view + the data, and you can do the rendering, eventually, interpolating the view-model data and rendering the compiled view with it."}),"\n",(0,o.jsxs)(n.p,{children:["When retrieving multiple components, a ",(0,o.jsx)(n.a,{href:"/docs/consumers/batch-endpoint",children:"batch POST endpoint"})," allows to make a single request to the API."]}),"\n",(0,o.jsx)(n.h2,{id:"web-framework-integration-examples",children:"Web Framework Integration Examples"}),"\n",(0,o.jsx)(n.h3,{id:"expressjs-integration",children:"Express.js Integration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const express = require('express');\nconst oc = require('oc-client-node');\n\nconst app = express();\nconst client = oc.Client({\n  registries: ['https://my-registry.com'],\n  components: {\n    cache: {\n      type: 'memory',\n      options: {\n        max: 100,\n        maxAge: 1000 * 60 * 5 // 5 minutes\n      }\n    }\n  }\n});\n\napp.get('/', async (req, res) => {\n  try {\n    const header = await client.renderComponent('header', { user: req.user });\n    const footer = await client.renderComponent('footer');\n    \n    res.render('index', { header: header.html, footer: footer.html });\n  } catch (error) {\n    console.error('Component rendering failed:', error);\n    res.render('index', { header: '', footer: '' });\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h3,{id:"koajs-integration",children:"Koa.js Integration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const Koa = require('koa');\nconst oc = require('oc-client-node');\n\nconst app = new Koa();\nconst client = oc.Client({ registries: ['https://my-registry.com'] });\n\napp.use(async (ctx) => {\n  try {\n    const components = await Promise.all([\n      client.renderComponent('navigation'),\n      client.renderComponent('content', { page: ctx.path })\n    ]);\n    \n    ctx.body = `\n      <html>\n        <body>\n          ${components[0].html}\n          ${components[1].html}\n        </body>\n      </html>\n    `;\n  } catch (error) {\n    ctx.status = 500;\n    ctx.body = 'Error rendering components';\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h3,{id:"nextjs-integration",children:"Next.js Integration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// pages/api/components/[...component].js\nimport oc from 'oc-client-node';\n\nconst client = oc.Client({\n  registries: ['https://my-registry.com']\n});\n\nexport default async function handler(req, res) {\n  const { component } = req.query;\n  const componentName = component[0];\n  \n  try {\n    const result = await client.renderComponent(componentName, req.query);\n    res.status(200).json(result);\n  } catch (error) {\n    res.status(500).json({ error: 'Component rendering failed' });\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"caching-strategies",children:"Caching Strategies"}),"\n",(0,o.jsx)(n.h3,{id:"redis-caching",children:"Redis Caching"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const redis = require('redis');\nconst client = redis.createClient();\n\nconst ocClient = oc.Client({\n  registries: ['https://my-registry.com'],\n  components: {\n    cache: {\n      type: 'redis',\n      options: {\n        client: client,\n        prefix: 'oc:',\n        ttl: 300 // 5 minutes\n      }\n    }\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h3,{id:"memory-caching-with-lru",children:"Memory Caching with LRU"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const LRU = require('lru-cache');\n\nconst cache = new LRU({\n  max: 500,\n  maxAge: 1000 * 60 * 10 // 10 minutes\n});\n\nconst ocClient = oc.Client({\n  registries: ['https://my-registry.com'],\n  components: {\n    cache: {\n      type: 'memory',\n      options: cache\n    }\n  }\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,o.jsx)(n.h3,{id:"graceful-fallbacks",children:"Graceful Fallbacks"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"async function renderComponentWithFallback(name, params, fallback = '') {\n  try {\n    const result = await client.renderComponent(name, params);\n    return result.html;\n  } catch (error) {\n    console.error(`Component ${name} failed:`, error);\n    return fallback;\n  }\n}\n\n// Usage\nconst header = await renderComponentWithFallback('header', { user }, '<header>Default Header</header>');\n"})}),"\n",(0,o.jsx)(n.h3,{id:"timeout-handling",children:"Timeout Handling"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const client = oc.Client({\n  registries: ['https://my-registry.com'],\n  timeout: 5000, // 5 seconds\n  retry: 3\n});\n"})}),"\n",(0,o.jsx)(n.h2,{id:"available-clients",children:"Available Clients"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/opencomponents/oc-client-browser",children:"Javascript browser client"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/opencomponents/oc-client-node",children:"Javascript Node.js client"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/opencomponents/oc-client-php",children:"PHP client"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/opencomponents/ruby-oc",children:"Ruby client"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/opencomponents/opencomponents-rails",children:"Rails client"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/opencomponents/sinatra-opencomponents",children:"Sinatra client"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>c});var t=r(6540);const o={},s=t.createContext(o);function i(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);