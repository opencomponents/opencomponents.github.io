"use strict";(self.webpackChunkoc_website=self.webpackChunkoc_website||[]).push([[4194],{6974:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"consumers/client-side-rendering","title":"Client-side Rendering","description":"Integration","source":"@site/docs/consumers/client-side-rendering.md","sourceDirName":"consumers","slug":"/consumers/client-side-rendering","permalink":"/docs/consumers/client-side-rendering","draft":false,"unlisted":false,"editUrl":"https://github.com/opencomponents/opencomponents.github.io/tree/master/website/docs/consumers/client-side-rendering.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Events & Hooks","permalink":"/docs/consumers/events-hooks"},"next":{"title":"Server-side Rendering","permalink":"/docs/consumers/server-side-rendering"}}');var s=t(4848),o=t(8453);const r={sidebar_position:5},c="Client-side Rendering",a={},d=[{value:"Integration",id:"integration",level:2},{value:"What exactly happens during a component&#39;s client-side rendering?",id:"what-exactly-happens-during-a-components-client-side-rendering",level:2},{value:"What can I do in the client-side?",id:"what-can-i-do-in-the-client-side",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"client-side-rendering",children:"Client-side Rendering"})}),"\n",(0,s.jsx)(n.h2,{id:"integration",children:"Integration"}),"\n",(0,s.jsx)(n.p,{children:"To make this happen, a components registry has to be publicly available.\nThis is how to integrate the component:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<html>\n  <head></head>\n  <body>\n    <oc-component\n      href="//my-components-registry.mydomain.com/hello-world/1.X.X"\n    ></oc-component>\n    <script src="//my-components-registry.mydomain.com/oc-client/client.js"><\/script>\n  </body>\n</html>\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"It is recommended to use protocol-less urls for rendering so that we can use https where possible for security reasons"}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"/oc-client/client.js"})," is a convenient shortcut for serving the browser oc-client of the ",(0,s.jsx)(n.strong,{children:"same version as the registry"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["The client can be before or after the components. When after, a rendering needs to happen via explicit call \u2013 see ",(0,s.jsx)(n.a,{href:"/docs/consumers/rendering-lifecycle",children:"advanced client-side operations"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"what-exactly-happens-during-a-components-client-side-rendering",children:"What exactly happens during a component's client-side rendering?"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"The first thing is for the client to be initialised. This includes verifying the required template runtimes are available"}),"\n",(0,s.jsxs)(n.li,{children:["At the end of the initialisation, the client is going to fire an event ",(0,s.jsx)(n.code,{children:"oc:ready"})]}),"\n",(0,s.jsxs)(n.li,{children:["Then the client is going to scan for ",(0,s.jsx)(n.code,{children:"<oc-component>"})," tags in the page and for each one of them:"]}),"\n",(0,s.jsxs)(n.li,{children:["It is going to make an HTTP GET to the ",(0,s.jsx)(n.code,{children:"href"})," parameter of the component, sending a ",(0,s.jsx)(n.code,{children:"Accept: application/vnd.oc.unrendered+json"})," header (which is the standard header for getting an unrendered component)."]}),"\n",(0,s.jsx)(n.li,{children:"In case of error (timeout or 5xx response) the client is going to retry 30 times (retry attempts and timeout are configurable)"}),"\n",(0,s.jsx)(n.li,{children:"In case of success, the client is going to find what kind of template the component uses and verify dependencies are satisfied. For ES6 templates (the default), it ensures the template function is ready. For legacy template types like Handlebars, it ensures the respective runtime is available and ready, downloading it if necessary before proceeding to the next step"}),"\n",(0,s.jsxs)(n.li,{children:["The client will take the compiled view url, for instance ",(0,s.jsx)(n.code,{children:"//cdn.com/components/my-component/1.2.3/template.js"})," and put it in the ",(0,s.jsx)(n.code,{children:"<head>"})," tag, then waiting for it to be ready. If the template is already there (for example because there are multiple components of the same type and version in the page) it is going to skip step 7. When the template is ready it is exposed in the ",(0,s.jsx)(n.code,{children:"window.oc.components['hash-of-the-component']"})," namespace as a function: ",(0,s.jsx)(n.code,{children:"view(viewModel)=html"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["This is going to take the viewModel (part of the HTTP response) and use it to render the view, ",(0,s.jsx)(n.strong,{children:"producing"})," the HTML. When finished, it places the HTML result inside the ",(0,s.jsx)(n.code,{children:"<oc-component>"})," container tag. Some templates may perform additional actions. In case of a React template, for instance, the HTML may be bound to the Virtual DOM."]}),"\n",(0,s.jsxs)(n.li,{children:["An ",(0,s.jsx)(n.code,{children:"oc:rendered"})," event is published containing the pointer to the component, and all the information (version, name, html, etc.)"]}),"\n",(0,s.jsxs)(n.li,{children:["Back to 3) ",(0,s.jsx)(n.strong,{children:"To render nested client-side components, if any are present"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"what-can-i-do-in-the-client-side",children:"What can I do in the client-side?"}),"\n",(0,s.jsxs)(n.p,{children:["Look at this page: ",(0,s.jsx)(n.a,{href:"rendering-lifecycle",children:"advanced client-side operations"})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var i=t(6540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);