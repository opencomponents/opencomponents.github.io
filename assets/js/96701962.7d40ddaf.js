"use strict";(self.webpackChunkoc_website=self.webpackChunkoc_website||[]).push([[8373],{7138:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"registry/registry-configuration","title":"Registry Configuration","description":"Introduction","source":"@site/docs/registry/registry-configuration.md","sourceDirName":"registry","slug":"/registry/registry-configuration","permalink":"/docs/registry/registry-configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/opencomponents/opencomponents.github.io/tree/master/website/docs/registry/registry-configuration.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Publishing to a registry","permalink":"/docs/components/publishing-to-a-registry"},"next":{"title":"Registry using Google Storage","permalink":"/docs/registry/registry-using-google-storage"}}');var r=t(4848),s=t(8453);const c={sidebar_position:1},o="Registry Configuration",d={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Setup",id:"setup",level:2},{value:"API",id:"api",level:2},{value:"var registry = new oc.Registry(configuration);",id:"var-registry--new-ocregistryconfiguration",level:3},{value:"registry.start(callback)",id:"registrystartcallback",level:3},{value:"registry.off(eventName, callback);",id:"registryoffeventname-callback",level:3},{value:"registry.on(eventName, callback);",id:"registryoneventname-callback",level:3},{value:"registry.register(plugin [, callback]);",id:"registryregisterplugin--callback",level:3},{value:"registry.reset(eventName);",id:"registryreseteventname",level:3},{value:"Registry configuration",id:"registry-configuration-1",level:2},{value:"Core Configuration Options",id:"core-configuration-options",level:3},{value:"Storage and Caching Options",id:"storage-and-caching-options",level:3},{value:"Development and Discovery Options",id:"development-and-discovery-options",level:3},{value:"Authentication and Security Options",id:"authentication-and-security-options",level:3},{value:"Component and Template Options",id:"component-and-template-options",level:3},{value:"Advanced Options",id:"advanced-options",level:3},{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Basic Registry Configuration",id:"basic-registry-configuration",level:3},{value:"Advanced Configuration with Authentication",id:"advanced-configuration-with-authentication",level:3},{value:"Local Development Configuration",id:"local-development-configuration",level:3},{value:"Custom Storage Adapter Configuration",id:"custom-storage-adapter-configuration",level:3},{value:"Publish Rate Limit Configuration",id:"publish-rate-limit-configuration",level:3},{value:"Publish validation example",id:"publish-validation-example",level:3},{value:"Routes example",id:"routes-example",level:3},{value:"Registry events",id:"registry-events",level:2},{value:"Plugins",id:"plugins",level:2},{value:"Plugin Structure",id:"plugin-structure",level:3},{value:"Basic Plugin Example",id:"basic-plugin-example",level:3},{value:"Context-Aware Plugin Example",id:"context-aware-plugin-example",level:3},{value:"Plugin Registration",id:"plugin-registration",level:3},{value:"Using Plugins from Components",id:"using-plugins-from-components",level:3},{value:"When to Use Context Awareness",id:"when-to-use-context-awareness",level:3},{value:"Advanced Context-Aware Plugin Example",id:"advanced-context-aware-plugin-example",level:3},{value:"Plugin Dependencies",id:"plugin-dependencies",level:3},{value:"Plugin Configuration Options",id:"plugin-configuration-options",level:3},{value:"Context Object Structure",id:"context-object-structure",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"registry-configuration",children:"Registry Configuration"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"The registry is a REST api that serves the components. You can have multiple registries connected to a library, but you can't have multiple libraries connected to a registry."}),"\n",(0,r.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,r.jsx)(n.p,{children:"First, create a dir and install oc:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"mkdir oc-registry && cd oc-registry\nnpm init\nnpm install oc --save\ntouch index.js\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For Google Storage registry configuration's documentation, ",(0,r.jsx)(n.a,{href:"/docs/registry/registry-using-google-storage",children:"look at this page"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["This is the ",(0,r.jsx)(n.code,{children:"index.js"})," content:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var oc = require("oc");\n\nvar configuration = {\n  verbosity: 0,\n  baseUrl: "https://my-components-registry.mydomain.com/",\n  port: 3000,\n  tempDir: "./temp/",\n  refreshInterval: 600,\n  pollingInterval: 5,\n  s3: {\n    key: "your-s3-key",\n    secret: "your-s3-secret",\n    bucket: "your-s3-bucket",\n    region: "your-s3-region",\n    path: "//s3.amazonaws.com/your-s3-bucket/",\n    componentsDir: "components",\n  },\n  env: { name: "production" },\n};\n\nvar registry = new oc.Registry(configuration);\n\nregistry.start(function (err, app) {\n  if (err) {\n    console.log("Registry not started: ", err);\n    process.exit(1);\n  }\n});\n'})}),"\n",(0,r.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,r.jsx)(n.h3,{id:"var-registry--new-ocregistryconfiguration",children:"var registry = new oc.Registry(configuration);"}),"\n",(0,r.jsxs)(n.p,{children:["Creates an instance of the registry. ",(0,r.jsx)(n.a,{href:"#registry-configuration",children:"Configuration"})," is an object that contains the registry configuration parameters."]}),"\n",(0,r.jsx)(n.h3,{id:"registrystartcallback",children:"registry.start(callback)"}),"\n",(0,r.jsx)(n.p,{children:"Starts the registry."}),"\n",(0,r.jsx)(n.h3,{id:"registryoffeventname-callback",children:"registry.off(eventName, callback);"}),"\n",(0,r.jsxs)(n.p,{children:["For unsubscribing to an ",(0,r.jsx)(n.a,{href:"#registry-events",children:"event"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"registryoneventname-callback",children:"registry.on(eventName, callback);"}),"\n",(0,r.jsxs)(n.p,{children:["For subscribing to an ",(0,r.jsx)(n.a,{href:"#registry-events",children:"event"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"registryregisterplugin--callback",children:"registry.register(plugin [, callback]);"}),"\n",(0,r.jsxs)(n.p,{children:["Register a ",(0,r.jsx)(n.a,{href:"#plugins",children:"plugin"}),".\nThe plugin parameter has to be a ",(0,r.jsx)(n.a,{href:"#plugins",children:"valid plugin"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'registry.register({\n  name: "doSomething",\n  register: require("my-oc-plugin"),\n  options: {\n    configuration: "value",\n  },\n});\n'})}),"\n",(0,r.jsx)(n.h3,{id:"registryreseteventname",children:"registry.reset(eventName);"}),"\n",(0,r.jsxs)(n.p,{children:["For unsuscribing to all ",(0,r.jsx)(n.a,{href:"#registry-events",children:"events"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"registry-configuration-1",children:"Registry configuration"}),"\n",(0,r.jsx)(n.h3,{id:"core-configuration-options",children:"Core Configuration Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Mandatory"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"baseUrl"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Public base URL where the registry is reachable by consumers. Must include the configured ",(0,r.jsx)(n.code,{children:"prefix"})," at the end (e.g. ",(0,r.jsx)(n.code,{children:"https://components.mycompany.com/"})," if ",(0,r.jsx)(n.code,{children:"prefix"})," is ",(0,r.jsx)(n.code,{children:"/"}),"). When it doesn't, the sanitiser will automatically append it."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"baseUrlFunc"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Dynamically compute the ",(0,r.jsx)(n.code,{children:"baseUrl"})," for the incoming request. If provided, it overrides the static ",(0,r.jsx)(n.code,{children:"baseUrl"}),". Function signature: ",(0,r.jsx)(n.code,{children:"(opts: { host?: string; secure: boolean }) => string"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"port"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"3000"})}),(0,r.jsxs)(n.td,{children:["Port the HTTP server listens on. Can also be set via ",(0,r.jsx)(n.code,{children:"process.env.PORT"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"prefix"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"/"'})}),(0,r.jsxs)(n.td,{children:["URL path prefix appended to every registry endpoint. Must start and end with a slash (e.g. ",(0,r.jsx)(n.code,{children:"/"}),", ",(0,r.jsx)(n.code,{children:"/components/"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"verbosity"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"0"})}),(0,r.jsx)(n.td,{children:"Verbosity level of the console logger (0 = silent)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"timeout"})}),(0,r.jsx)(n.td,{children:"number (milliseconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"120000"})}),(0,r.jsx)(n.td,{children:"HTTP request timeout in milliseconds"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"keepAliveTimeout"})}),(0,r.jsx)(n.td,{children:"number (milliseconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5000"})}),(0,r.jsx)(n.td,{children:"Milliseconds the HTTP server keeps idle connections alive"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"storage-and-caching-options",children:"Storage and Caching Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Mandatory"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Convenience S3 configuration \u2013 if present the registry will create a storage adapter automatically"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.bucket"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"S3 bucket name (*required if using s3)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.region"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"S3 region (*required if using s3)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.key"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"S3 access key. Either specify both key/secret or skip both when leveraging IAM Role based S3 access from EC2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.secret"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"S3 secret. Either specify both key/secret or skip both when leveraging IAM Role based S3 access from EC2"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.componentsDir"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Path where the data will be saved inside the bucket (*required if using s3)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.path"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Path used for composing static resources' URLs. Can be the S3 URL, or when using CloudFront: ",(0,r.jsx)(n.code,{children:"//cloudfront-id.cloudfront.net/"}),". Should not include the protocol (*required if using s3)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.timeout"})}),(0,r.jsx)(n.td,{children:"number (milliseconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"10000"})}),(0,r.jsx)(n.td,{children:"Timeout for S3 requests"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"s3.agentProxy"})}),(0,r.jsx)(n.td,{children:"instance of http agent"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Custom agent for interacting with AWS API via proxy. Usage: ",(0,r.jsx)(n.code,{children:"agentProxy = require('proxy-agent')('https://yourproxy.com');"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"storage"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Low-level storage adapter configuration. Use this for non-S3 storage adapters"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"storage.adapter"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Storage adapter function that returns a StorageAdapter instance (*required if using storage)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"storage.options"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Options passed to the storage adapter, must include ",(0,r.jsx)(n.code,{children:"componentsDir"})," (*required if using storage)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"refreshInterval"})}),(0,r.jsx)(n.td,{children:"number (seconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Seconds between each refresh of the internal component list cache. Given the data is immutable, this should be high and just for robustness"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"pollingInterval"})}),(0,r.jsx)(n.td,{children:"number (seconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:"Seconds between each poll of the storage adapter for changes. Should be low (5-10 seconds) for efficient distribution"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"tempDir"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"./temp/"'})}),(0,r.jsx)(n.td,{children:"Directory where components' packages are temporarily stored during publishing"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"development-and-discovery-options",children:"Development and Discovery Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Mandatory"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"discovery"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsxs)(n.td,{children:["Enables the HTML discovery page and ",(0,r.jsx)(n.code,{children:"/components"})," endpoint"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"discoveryFunc"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Function to decide whether discovery should be enabled for the current request. Function signature: ",(0,r.jsx)(n.code,{children:"(opts: { host?: string; secure: boolean }) => boolean"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"local"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Indicates whether the registry serves components from the local file system (",(0,r.jsx)(n.code,{children:"true"}),") or from remote storage (",(0,r.jsx)(n.code,{children:"false"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"path"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Absolute path where local components are stored (used when ",(0,r.jsx)(n.code,{children:"local"})," is ",(0,r.jsx)(n.code,{children:"true"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"hotReloading"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"!!local"})}),(0,r.jsxs)(n.td,{children:["Enables hot-reloading of component code. Always ",(0,r.jsx)(n.code,{children:"true"})," when ",(0,r.jsx)(n.code,{children:"local"})," is ",(0,r.jsx)(n.code,{children:"true"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"liveReloadPort"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"TCP port of the LiveReload server used by the preview page"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"compileClient"})}),(0,r.jsx)(n.td,{children:"boolean or object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsxs)(n.td,{children:["Set options for the oc-client-browser compilation. Set to ",(0,r.jsx)(n.code,{children:"false"})," to disable client compilation, or provide options object for custom compilation settings"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"authentication-and-security-options",children:"Authentication and Security Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Mandatory"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishAuth"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Authentication strategy for component publishing. When ",(0,r.jsx)(n.code,{children:"undefined"}),", no authorization is required"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishAuth.type"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Authentication type. Supports ",(0,r.jsx)(n.code,{children:'"basic"'})," or custom authentication objects"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishAuth.username"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Username for basic authentication (when type is ",(0,r.jsx)(n.code,{children:'"basic"'}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishAuth.password"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Password for basic authentication (when type is ",(0,r.jsx)(n.code,{children:'"basic"'}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishAuth.logins"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Array of login objects for multiple users: ",(0,r.jsx)(n.code,{children:'[{ username: "user1", password: "pass1" }, ...]'})," (when type is ",(0,r.jsx)(n.code,{children:'"basic"'}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishValidation"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Custom validation logic executed during component publishing. Function signature: ",(0,r.jsx)(n.code,{children:"(pkgJson: unknown, context: { user?: string }) => { isValid: boolean; error?: string } | boolean"}),". ",(0,r.jsx)(n.a,{href:"#publish-validation-example",children:"See example"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Rate-limiting configuration for component publishing. When ",(0,r.jsx)(n.code,{children:"undefined"}),", no throttling is applied"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit.windowMs"})}),(0,r.jsx)(n.td,{children:"number (milliseconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"900000"})}),(0,r.jsx)(n.td,{children:"Size of the sliding window used for rate limiting. Defaults to 15 minutes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit.max"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"100"})}),(0,r.jsxs)(n.td,{children:["Maximum number of publish requests allowed within ",(0,r.jsx)(n.code,{children:"windowMs"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit.keyGenerator"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Function that returns the identifier used for counting hits (defaults to ",(0,r.jsx)(n.code,{children:"${req.ip}:${req.user ?? 'anon'}"}),"). Signature: ",(0,r.jsx)(n.code,{children:"(req: Request) => string"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit.skip"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Predicate to bypass throttling for specific requests/users. Signature: ",(0,r.jsx)(n.code,{children:"(req: Request) => boolean"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit.store"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"In-memory"}),(0,r.jsxs)(n.td,{children:["Custom storage backend implementing the ",(0,r.jsx)(n.code,{children:"RateLimitStore"})," interface"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"publishRateLimit.maxCacheSize"})}),(0,r.jsx)(n.td,{children:"number"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"1000"})}),(0,r.jsx)(n.td,{children:"Maximum number of rate-limit entries the default in-memory store keeps"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"component-and-template-options",children:"Component and Template Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Mandatory"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"components"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Restricts the registry to serve only the specified component names. Useful for component-specific registries"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"dependencies"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[]"})}),(0,r.jsxs)(n.td,{children:["Names of npm packages that components can ",(0,r.jsx)(n.code,{children:"require"})," at runtime. Example: ",(0,r.jsx)(n.code,{children:'["lodash", "moment"]'})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"templates"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[]"})}),(0,r.jsx)(n.td,{children:"List of template engines available for rendering components. Extends the default base templates"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"executionTimeout"})}),(0,r.jsx)(n.td,{children:"number (seconds)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Maximum execution time of a component's server-side logic in seconds. When the timeout elapses, the registry returns a 500 error"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"tarExtractMode"})}),(0,r.jsx)(n.td,{children:"number (octal)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"0o766"})}),(0,r.jsx)(n.td,{children:"File and directory mode (octal) applied when extracting tarballs during publishing"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"advanced-options",children:"Advanced Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Mandatory"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"env"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"{}"})}),(0,r.jsxs)(n.td,{children:["Environment variables passed to components in ",(0,r.jsx)(n.code,{children:"context.env"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"fallbackRegistryUrl"})}),(0,r.jsx)(n.td,{children:"string (url)"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"URL of a secondary registry that will be queried if a component cannot be found on this instance. A trailing slash is appended automatically"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"customHeadersToSkipOnWeakVersion"})}),(0,r.jsx)(n.td,{children:"array"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"[]"})}),(0,r.jsx)(n.td,{children:"List of header names (lower-case) to omit from the response when a fallback/weak component version is served (e.g. 1.x.x rather than 1.2.3). Useful for cache headers on components with static logic"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"postRequestPayloadSize"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Maximum allowed ",(0,r.jsx)(n.code,{children:"Content-Length"})," for publish requests. Accepts any value supported by the ",(0,r.jsx)(n.code,{children:"bytes"}),' module (e.g. "10mb", "50mb"). When unset, the limit is 100KB']})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"routes"})}),(0,r.jsx)(n.td,{children:"array of objects"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsxs)(n.td,{children:["Additional Express routes to mount on the registry application. ",(0,r.jsx)(n.a,{href:"#routes-example",children:"See example"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"routes[].route"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"URL pattern for the route. Should be outside of the components' namespace (*required for each route)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"routes[].method"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:'HTTP method for the route (e.g. "get", "post") (*required for each route)'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"routes[].handler"})}),(0,r.jsx)(n.td,{children:"function"}),(0,r.jsx)(n.td,{children:"yes*"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Express-compatible handler function for the route (*required for each route)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)("sub",{children:"plugins"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"{}"})}),(0,r.jsxs)(n.td,{children:["Collection of plugins initialized for this registry instance. Populated via ",(0,r.jsx)(n.code,{children:"registry.register(...)"})]})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,r.jsx)(n.h3,{id:"basic-registry-configuration",children:"Basic Registry Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var oc = require("oc");\n\nvar configuration = {\n  baseUrl: "https://components.mycompany.com/",\n  port: 3000,\n  verbosity: 1,\n  discovery: true,\n  s3: {\n    bucket: "my-components-bucket",\n    region: "us-east-1",\n    componentsDir: "components",\n    path: "//s3.amazonaws.com/my-components-bucket/",\n  },\n};\n\nvar registry = new oc.Registry(configuration);\nregistry.start();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"advanced-configuration-with-authentication",children:"Advanced Configuration with Authentication"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var oc = require("oc");\n\nvar configuration = {\n  baseUrl: "https://components.mycompany.com/",\n  port: 3000,\n  verbosity: 1,\n\n  // Authentication for publishing\n  publishAuth: {\n    type: "basic",\n    logins: [\n      { username: "developer1", password: "secure-password-1" },\n      { username: "developer2", password: "secure-password-2" },\n    ],\n  },\n\n  // Custom validation\n  publishValidation: function (packageJson, context) {\n    if (!packageJson.author || !packageJson.description) {\n      return {\n        isValid: false,\n        error: "Package must have author and description",\n      };\n    }\n    return { isValid: true };\n  },\n\n  // Storage configuration\n  s3: {\n    bucket: "my-components-bucket",\n    region: "us-east-1",\n    componentsDir: "components",\n    path: "//cloudfront-id.cloudfront.net/",\n  },\n\n  // Runtime dependencies\n  dependencies: ["lodash", "moment", "axios"],\n\n  // Environment variables\n  env: {\n    NODE_ENV: "production",\n    API_BASE_URL: "https://api.mycompany.com",\n  },\n};\n\nvar registry = new oc.Registry(configuration);\nregistry.start();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"local-development-configuration",children:"Local Development Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var oc = require("oc");\n\nvar configuration = {\n  baseUrl: "http://localhost:3000/",\n  port: 3000,\n  verbosity: 2,\n  local: true,\n  path: "./components",\n  hotReloading: true,\n  discovery: true,\n  liveReloadPort: 35729,\n  compileClient: true,\n};\n\nvar registry = new oc.Registry(configuration);\nregistry.start();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"custom-storage-adapter-configuration",children:"Custom Storage Adapter Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var oc = require("oc");\nvar customStorageAdapter = require("my-custom-storage-adapter");\n\nvar configuration = {\n  baseUrl: "https://components.mycompany.com/",\n  port: 3000,\n  storage: {\n    adapter: customStorageAdapter,\n    options: {\n      componentsDir: "components",\n      connectionString: "mongodb://localhost:27017/components",\n      // other adapter-specific options\n    },\n  },\n  refreshInterval: 300,\n  pollingInterval: 10,\n};\n\nvar registry = new oc.Registry(configuration);\nregistry.start();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"publish-rate-limit-configuration",children:"Publish Rate Limit Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'var oc = require("oc");\n\nvar configuration = {\n  baseUrl: "https://components.mycompany.com/",\n  port: 3000,\n\n  // Throttle component publishing to max 50 requests per 10-minute window\n  publishRateLimit: {\n    windowMs: 10 * 60 * 1000, // 10 minutes\n    max: 50,\n    // Optional fine-tuning examples:\n    // keyGenerator: (req) => `${req.ip}:${req.user ?? \'anon\'}`,\n    // skip: (req) => req.user === "ci-bot",            // allow automated CI\n    // store: new RedisRateLimitStore(),                  // pluggable backend\n    // maxCacheSize: 5000,\n  },\n};\n\nvar registry = new oc.Registry(configuration);\nregistry.start();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"publish-validation-example",children:"Publish validation example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'options.publishValidation = function (packageJson, context) {\n  var isValid =\n    !!packageJson.author &&\n    !!packageJson.repository &&\n    !!packageJson.description;\n\n  if (isValid) {\n    // Can return boolean\n    return true;\n  } else {\n    // Can return object with error so that it will be propagated to the user\n    return {\n      isValid: false,\n      error:\n        "Package.json is missing mandatory params: author, repository, description",\n    };\n  }\n};\n\n// Advanced validation example with context\noptions.publishValidation = function (packageJson, context) {\n  // Access the authenticated user\n  var user = context.user;\n\n  // Validate based on user permissions\n  if (user === "admin") {\n    return { isValid: true };\n  }\n\n  // Regular users have restrictions\n  if (!packageJson.name.startsWith("user-components/")) {\n    return {\n      isValid: false,\n      error:\n        "Regular users can only publish components with \'user-components/\' prefix",\n    };\n  }\n\n  return { isValid: true };\n};\n'})}),"\n",(0,r.jsx)(n.h3,{id:"routes-example",children:"Routes example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'options.routes = [\n  {\n    route: "/example-route",\n    method: "get",\n    handler: function (req, res) {\n      // Handling function content\n    },\n  },\n];\n'})}),"\n",(0,r.jsx)(n.h2,{id:"registry-events",children:"Registry events"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Event name"}),(0,r.jsx)(n.th,{children:"Callback Data Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"cache-poll"}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Fired when the components list is refreshed. The callback data contains the last edit unix utc timestamp."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"component-retrieved"}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Fired when the component is retrieved. This includes the component's validation, data gathering and execution, view retrieving, and (when requested) rendering. The callback data contains the duration, component details, and, in case, the error details."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"error"}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Fired when an internal operation errors."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"request"}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"Fired every time the registry receives a request. The callback data contains some request and response details."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"start"}),(0,r.jsx)(n.td,{children:"undefined"}),(0,r.jsx)(n.td,{children:"Fired when the registry starts"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"plugins",children:"Plugins"}),"\n",(0,r.jsx)(n.p,{children:"Plugins are a way to extend registry's context allowing components to inherit custom functionalities. They can be configured to receive component context information (name and version) when needed for enhanced security and decision-making capabilities."}),"\n",(0,r.jsx)(n.h3,{id:"plugin-structure",children:"Plugin Structure"}),"\n",(0,r.jsx)(n.p,{children:"A plugin consists of two main parts:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"register"}),": Function called during plugin initialization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"execute"}),": Function that provides the actual plugin functionality"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"context"})," (optional): Boolean flag to enable component context awareness"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"basic-plugin-example",children:"Basic Plugin Example"}),"\n",(0,r.jsx)(n.p,{children:"This is a basic plugin example without context awareness:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// ./registry/oc-plugins/hobknob.js\nvar connection,\n  client = require("./hobknob-client");\n\nmodule.exports.register = function (options, dependencies, next) {\n  client.connect(options.connectionString, function (err, conn) {\n    connection = conn;\n    next();\n  });\n};\n\nmodule.exports.execute = function (featureName) {\n  return connection.get(featureName);\n};\n'})}),"\n",(0,r.jsx)(n.h3,{id:"context-aware-plugin-example",children:"Context-Aware Plugin Example"}),"\n",(0,r.jsx)(n.p,{children:"When you need to make decisions based on which component is calling the plugin, you can enable context awareness:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// ./registry/oc-plugins/feature-flags.js\nvar connection,\n  client = require("./feature-flags-client");\n\nmodule.exports.register = function (options, dependencies, next) {\n  client.connect(options.connectionString, function (err, conn) {\n    connection = conn;\n    next();\n  });\n};\n\n// With context: true, execute receives component context and returns a function\nmodule.exports.execute = function (context) {\n  // context contains: { name: "component-name", version: "1.2.3" }\n  return function (featureName) {\n    // Validate if this component is allowed to access this feature\n    if (\n      context.name.startsWith("internal/") &&\n      featureName.startsWith("public/")\n    ) {\n      throw new Error("Internal components cannot access public features");\n    }\n\n    // Log feature access for audit purposes\n    console.log(\n      `Component ${context.name}@${context.version} accessing feature: ${featureName}`\n    );\n\n    return connection.get(featureName);\n  };\n};\n\n// Enable context awareness\nmodule.exports.context = true;\n'})}),"\n",(0,r.jsx)(n.h3,{id:"plugin-registration",children:"Plugin Registration"}),"\n",(0,r.jsx)(n.p,{children:"This is how to register plugins in a registry:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// ./registry/init.js\nvar oc = require("oc");\nvar registry = new oc.Registry(configuration);\n\n// Register a basic plugin\nregistry.register({\n  name: "getFeatureSwitch",\n  register: require("./oc-plugins/hobknob"),\n  options: {\n    connectionString: connectionString,\n  },\n});\n\n// Register a context-aware plugin\nregistry.register({\n  name: "getSecureFeature",\n  register: require("./oc-plugins/feature-flags"),\n  options: {\n    connectionString: connectionString,\n  },\n});\n'})}),"\n",(0,r.jsx)(n.h3,{id:"using-plugins-from-components",children:"Using Plugins from Components"}),"\n",(0,r.jsx)(n.p,{children:"Components use plugins the same way regardless of whether they have context awareness:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// ./my-component/server.js\nmodule.exports.data = function (context, callback) {\n  callback(null, {\n    // Basic plugin usage\n    basicFeature: context.plugins.getFeatureSwitch("AbTestHomePage"),\n\n    // Context-aware plugin usage (same interface)\n    secureFeature: context.plugins.getSecureFeature("AdminPanel"),\n  });\n};\n'})}),"\n",(0,r.jsx)(n.h3,{id:"when-to-use-context-awareness",children:"When to Use Context Awareness"}),"\n",(0,r.jsx)(n.p,{children:"Context awareness is useful when you need to:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security Validation"}),": Restrict certain components from accessing specific features"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Audit Logging"}),": Track which components are using which features"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Component-Specific Logic"}),": Provide different behavior based on component name/version"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limiting"}),": Apply different limits per component"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Feature Rollouts"}),": Enable features only for specific components or versions"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"advanced-context-aware-plugin-example",children:"Advanced Context-Aware Plugin Example"}),"\n",(0,r.jsx)(n.p,{children:"Here's a more sophisticated example that demonstrates multiple use cases:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// ./registry/oc-plugins/advanced-feature-manager.js\nvar connection,\n  client = require("./feature-manager-client");\n\nmodule.exports.register = function (options, dependencies, next) {\n  client.connect(options.connectionString, function (err, conn) {\n    connection = conn;\n    next();\n  });\n};\n\nmodule.exports.execute = function (context) {\n  return function (featureName, options = {}) {\n    // Security: Check component permissions\n    const componentPermissions = getComponentPermissions(context.name);\n    if (!componentPermissions.canAccess(featureName)) {\n      throw new Error(\n        `Component ${context.name} is not authorized to access ${featureName}`\n      );\n    }\n\n    // Audit: Log all feature access\n    logFeatureAccess({\n      component: context.name,\n      version: context.version,\n      feature: featureName,\n      timestamp: new Date().toISOString(),\n    });\n\n    // Rate limiting: Apply different limits per component\n    const rateLimit = getRateLimit(context.name, featureName);\n    if (isRateLimited(context.name, featureName, rateLimit)) {\n      throw new Error(\n        `Rate limit exceeded for ${context.name} accessing ${featureName}`\n      );\n    }\n\n    // Version-specific logic\n    if (context.version.startsWith("2.")) {\n      // New API for v2+ components\n      return connection.getV2(featureName, options);\n    } else {\n      // Legacy API for older components\n      return connection.getV1(featureName);\n    }\n  };\n};\n\nmodule.exports.context = true;\n'})}),"\n",(0,r.jsx)(n.h3,{id:"plugin-dependencies",children:"Plugin Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"Plugins can depend on other plugins, and context awareness works with dependencies:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'// ./registry/oc-plugins/secure-logger.js\nvar connection,\n  client = require("./logger-client");\n\nmodule.exports.dependencies = ["log", "otherplugin"];\n\nmodule.exports.register = function (options, dependencies, next) {\n  // This register function is only called after all dependencies are registered\n  client.connect(options.connectionString, function (err, conn) {\n    connection = conn;\n    dependencies.log("secure logger client initialized");\n    next();\n  });\n};\n\nmodule.exports.execute = function (context) {\n  return function (message, level = "info") {\n    // Add component context to all log messages\n    const enrichedMessage = {\n      component: context.name,\n      version: context.version,\n      message: message,\n      level: level,\n      timestamp: new Date().toISOString(),\n    };\n\n    return connection.log(enrichedMessage);\n  };\n};\n\nmodule.exports.context = true;\n'})}),"\n",(0,r.jsx)(n.h3,{id:"plugin-configuration-options",children:"Plugin Configuration Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Property"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Required"}),(0,r.jsx)(n.th,{children:"Default"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"name"})}),(0,r.jsx)(n.td,{children:"string"}),(0,r.jsx)(n.td,{children:"yes"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Unique identifier for the plugin"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"register"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"yes"}),(0,r.jsx)(n.td,{children:"-"}),(0,r.jsx)(n.td,{children:"Plugin module with register and execute functions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"options"})}),(0,r.jsx)(n.td,{children:"object"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"{}"})}),(0,r.jsx)(n.td,{children:"Configuration options passed to the plugin"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"context"})}),(0,r.jsx)(n.td,{children:"boolean"}),(0,r.jsx)(n.td,{children:"no"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Enable component context awareness"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"context-object-structure",children:"Context Object Structure"}),"\n",(0,r.jsxs)(n.p,{children:["When ",(0,r.jsx)(n.code,{children:"context: true"})," is set, the context object passed to the execute function contains:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'{\n  name: "component-name",      // The name of the component calling the plugin\n  version: "1.2.3"            // The version of the component calling the plugin\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var i=t(6540);const r={},s=i.createContext(r);function c(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);